var updateQueryString=require("./util/update-query-string");module.exports=function(t,u,n){var e,r=(u=u||{}).requestOptions||{},s=(r.requestMethod||"GET").toUpperCase(),a=r.requestParams||null,o=r.formData||null,l=null,i=new XMLHttpRequest,c=u.timeout||0;if(i.onreadystatechange=function(){4===i.readyState&&(200===i.status?n(i.responseText,i,t,u):0!==i.status&&n(null,i,t,u))},i.onerror=function(e){console.log(e),n(null,i,t,u)},i.ontimeout=function(){n(null,i,t,u)},a&&a.length)switch(e=a.map(function(e){return e.name+"="+e.value}).join("&"),s){case"GET":t=t.split("?")[0],t+="?"+e;break;case"POST":l=e}else o&&(l=o);return u.cacheBust&&(t=updateQueryString(t,"t",Date.now())),i.open(s,t,!0),i.timeout=c,i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.setRequestHeader("X-PJAX","true"),i.setRequestHeader("X-PJAX-Selectors",JSON.stringify(u.selectors)),l&&"POST"===s&&!o&&i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send(l),i};